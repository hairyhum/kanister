import{_ as s,c as i,o as a,V as e}from"./chunks/framework.CiLzNYv1.js";const g=JSON.parse('{"title":"Troubleshooting","description":"","frontmatter":{},"headers":[],"relativePath":"troubleshooting.md","filePath":"troubleshooting.md"}'),t={name:"troubleshooting.md"},n=e(`<h1 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h1><p>If an ActionSet fails to perform an action, then the failure events can be seen in the respective ActionSet as well as its associated Blueprint by using the following commands:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Example of failure events in an ActionSet:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl --namespace kanister describe actionset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ActionSet Nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Events:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Reason                          Age   From                 Message</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                          ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                 -------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Normal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Started Action                  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s   Kanister Controller  Executing action delete</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Normal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Started Phase                   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s   Kanister Controller  Executing phase deleteFromS3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Warning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ActionSetFailed Action: delete  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s   Kanister Controller  Failed to run phase </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of action delete: command terminated with exit code </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Example of failure events of ActionSet emitted to its associated Blueprint:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl --namespace kanister describe blueprint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Blueprint Nam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Events:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Reason                           Age   From                 Message</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     ------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                           ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  ----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                 -------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Normal</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Added                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">m   Kanister Controller  Added blueprint &#39;Blueprint Name&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Warning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ActionSetFailed Action: delete   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">m   Kanister Controller  Failed to run phase </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of action delete: command terminated with exit code </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></div><p>If you ever need to debug a live Kanister system and the information available in ActionSets you might have created is not enough, looking at the Kanister controller logs might help. Assuming you have deployed the controller in the <code>kanister</code> namespace, you can use the following commands to get controller logs.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl get pods --namespace kanister</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                           READY     STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">release-kanister-operator-1484730505-l443d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/1       Running   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl logs -f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">operator-pod-name-from-abov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kanister</span></span></code></pre></div><p>If you are not successful in verifying the reason behind the failure, please reach out to us on <a href="https://join.slack.com/t/kanisterio/shared_invite/enQtNzg2MDc4NzA0ODY4LTU1NDU2NDZhYjk3YmE5MWNlZWMwYzk1NjNjOGQ3NjAyMjcxMTIyNTE1YzZlMzgwYmIwNWFkNjU0NGFlMzNjNTk" target="_blank" rel="noreferrer">Slack</a> or file an issue on <a href="https://github.com/kanisterio/kanister/issues" target="_blank" rel="noreferrer">GitHub</a>. A <a href="https://groups.google.com/forum/#!forum/kanisterio" target="_blank" rel="noreferrer">mailing list</a> is also available if needed.</p><h2 id="validating-webhook-for-blueprints" tabindex="-1">Validating webhook for Blueprints <a class="header-anchor" href="#validating-webhook-for-blueprints" aria-label="Permalink to &quot;Validating webhook for Blueprints&quot;">​</a></h2><p>For the validating webhook to work, the Kubernetes API Server needs to connect to port <code>9443</code> of the Kanister operator. If your cluster has a firewall setup, it has to be configured to allow that communication.</p><h3 id="gke" tabindex="-1">GKE <a class="header-anchor" href="#gke" aria-label="Permalink to &quot;GKE&quot;">​</a></h3><p>If you get an error while applying a blueprint, that the webhook can&#39;t be reached, check if your firewall misses a rule for port <code>9443</code>:</p><div class="language-console vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">console</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ kubectl apply -f blueprint.yaml</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Error from server (InternalError): error when creating &quot;blueprint.yaml&quot;: Internal error occurred: failed calling webhook &quot;blueprints.cr.kanister.io&quot;: failed to call webhook: Post &quot;https://kanister-kanister-operator.kanister.svc:443/validate/v1alpha1/blueprint?timeout=5s&quot;: context deadline exceeded</span></span></code></pre></div><p>See <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters#add_firewall_rules" target="_blank" rel="noreferrer">GKE: Adding firewall rules for specific use cases</a> and <a href="https://github.com/kubernetes/kubernetes/issues/79739" target="_blank" rel="noreferrer">kubernetes/kubernetes: Using non-443 ports for admission webhooks requires firewall rule in GKE</a> for more details.</p>`,12),l=[n];function h(r,p,k,o,d,F){return a(),i("div",null,l)}const u=s(t,[["render",h]]);export{g as __pageData,u as default};
